---
title: Use Harbor as the default container repository to mirror Rainbond, expand Rainbod mirror management capability
description: Harbor is an enterprise-level registration server for storing and distributing Docker mirrors
slug: Harbor
image: https://static.goodrain.com/wechat/harbor/harbor.png
---

Rainbond, an integrated cloud native application management platform, provides an abstraction based on applications, and users do not need to learn K8 and the container, which encapsulates K8 and containers internally, can greatly enhance ease of use and ease of installation, but the replacement of encapsulated internal components is a question of how to replace the original default mirror warehouse in Rainbond, using Harbor.

## Introduction to Harbor

[**Harbor**](https://goharbor.io/) is an enterprise-level registration server for storing and distributing Docker mirrors, and an open-source DockerRegistry, the first Chinese original Yun Native Foundation (CNCF), extending the distribution of the Open Source Docker by adding the functional attributes necessary for some enterprises, such as security, labelling, and management.As an enterprise-level private registry server, Harbor provides better performance and security.Increases the efficiency of users to build and run environmental transfer mirrors using Registry.

## Seek Harbor to solve the problem of managing the Rainbod mirror.

The base registration provided by the Docker was used as the default prior to Reinbond, and there are many problems in the process of use, such as mirror security, mirror clearance of complex troubles, etc. Harbor not only addresses these problems but also expands many mirror management capabilities. Harbor functions primarily include tear：multi-user controls (based on role access control and project isolation), mirror management strategies (storage quotas, product retention, hole scanning, source signatures, immutable products, garbage recovery, etc.), security and compliance (identity authentication, scanning and CVE exception rules) and interoperability (Webhook, remote reproduction, pluginable scanners, REST API, robot account number, etc.).

## Pass Harbor

At present, both types of pairs of Rainbond, one as internal base storage repository for rainbond, and the other as external custom mirrors warehouses, are supported.

- As the internal base storage depot for Rainbond, Harbor is very simple to interact, but only to customize the cluster of initialization platforms.

![](https://pic.imgdb.cn/item/61a429c02ab3f51d9106c4f1.jpg)

Strict format requirements for both Yaml files are so strict that they avoid problems when configured. The correct yaml file has been placed below and can be copied.

**Note that：** must change the name of the repository, the project name of the repository, the user name, and the password, or else the image upload fails.

```
Example：
apiVersion: rainbod. o/v1alpha1
kind: RainbonCluster
metadata:
  name: rainbondcluster
  namespace: rbd-system
spec:
  imageHub:
    domain: www.. st.com/test
    password: Harbor12345
    username: admin
```

- Harbor provides services as an external repository for rainbond, based on harbor's and rainbond's webhook features and configured as follows.
  - The component has enabled webhook for mirror repositories, application status is not closed, and needs to configure the application's webhooks url to the target mirror repository for webhooks

![](https://pic.imgdb.cn/item/61a5951a2ab3f51d919ea0df.png)

- Destination mirror repository, create a new webhook and fill in the app's webhooks url at the Endpoint address. Configure the type of triggering events that fit the needs

![](https://pic.imgdb.cn/item/61a5951a2ab3f51d919ea0ea.png)

- Mirror visualization storage management through Harbor improves the ease of work.

![](https://pic.imgdb.cn/item/61a6cabf2ab3f51d9172ca88.png)

- Building based on Rainbond, automatic scanning of loopholes, improves security management.

![](https://pic.imgdb.cn/item/61a6cb0e2ab3f51d9172f17e.png)

- A strategy to clean automatically with mirror images, make rational use of storage and reduce storage costs.

  - It is recommended to apply policy：to the repository match\*\* and keep 3 recently pushed artifacts based on condition tags\*\*\* based on condition no Tag
  - Recommended clean：custom cron time: 0 0 0 1 _/1_ (seconds,minutes,month,weeks)
- Whether the mirror is signed, the level of the hole, and can be set as one of the mirror security strategies to ensure that a signed mirror or a low-grade image image can be pulled out.

## Integrate the whole process

![](https://pic.imgdb.cn/item/61a439b22ab3f51d910d5d1c.png)

It can be seen through the flow chart above that the entire loading configuration process allows the user to customize the image source to pull the image, automatically push it to the Harbor repository via the Rainbod platform, and then automatically pull it after completion of the mirror scanning and auto-build container instances.
