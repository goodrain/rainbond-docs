---
title: Deploy a highly available Apollo cluster on Rainbond
description: The current document describes how to install the Apollo cluster high with the Rainbond, on the cloud native application management platform.This approach is suitable for users who do not understand the complex technologies of Kubernetes, packaging, etc. and reduces the threshold for deploying Apollo in Kubernetes.
slug: apollo
image: https://static.goodrain.com/wechat/apollo/apollo.png
---

:::info current document describes how to install a high-availability Apollo cluster with one click through the cloud-native application management platform [Rainbond](https://www.rainbond.com).This method is suitable for users who are not familiar with complex technologies such as Kubernetes and containerization, and lowers the threshold for deploying Apollo in Kubernetes.
:::This approach is suitable for users who do not understand the complex technologies of Kubernetes, packaging, etc. and reduces the threshold for deploying Apollo in Kubernetes.

<!--truncate-->

## 1. Background information

### 1.1 The combination of Rainbond and Apollo

[Rainbond](https://www.rainbond.com) is an easy-to-use open source cloud-native application management platform.

With it, users can complete the deployment and operation and maintenance of microservices in a graphical interface.

With the help of the capabilities of Kubernetes and containerization technology, automatic operation and maintenance capabilities such as fault self-healing and elastic scaling can be empowered to users' businesses.

Rainbond has a built-in native Service Mesh microservice framework, and also has a good integration experience with other microservice frameworks such as Spring Cloud and Dubbo.

Therefore, a large number of Rainbond users may also be users of the Apollo distributed configuration management center.

Such users no longer need to care about how to deploy the Apollo cluster. The Rainbond team made Apollo an application template that can be deployed with one click, which is free for open source users to download and install.

This installation method greatly reduces the deployment burden of users using the Apollo cluster, and currently supports version 1.9.2.

In the current installation method, a set of `PRO` environment is integrated by default, and other environments are added. See the Advanced Features section later.

### 1.2 About application templates

The application template is an installation package for the Rainbond cloud-native application management platform. Based on it, users can install business systems into their own Rainbond with one click.No matter how complex the business system is, the application template will abstract it into an application, and install it together with the images, configuration information of all components in the application, and the relationship between all components.无论这个业务系统多么复杂，应用模版都会将其抽象成为一个应用，裹挟着应用内所有组件的镜像、配置信息以及所有组件之间的关联关系一并安装起来。

## 2. Preconditions

- The deployed Rainbond cloud-native application management platform：such as [Quick Experience Version](https://www.rainbond.com/docs/quick-start/quick-install/?channel=apollo)can run in a personal PC environment at the cost of starting a container.

- Can connect to the Internet.

## 3. Quick start

### 3.1 Access the built-in open source app store

Select the **app market** tab on the left, switch to the **open source app store** tab on the page, and search for the keywords **apollo** to find the Apollo app.

![apollo-1](https://static.goodrain.com/wechat/apollo/apollo-1.png)

### 3.2 One-click installation

Click **to install** on the right side of Apollo to enter the installation page. After filling in the simple information, click **to confirm** to start the installation. The page automatically jumps to the topology view.

![apollo-2](https://static.goodrain.com/wechat/apollo/apollo-2.png)

parameter description：

| options               | illustrate                                                                                          |
| --------------------- | --------------------------------------------------------------------------------------------------- |
| Team Name             | User-created workspace, isolated by namespace                                                       |
| cluster name          | Choose which K8s cluster Apollo is deployed to                                                      |
| Choose an application | Choose which application Apollo is deployed to, the application contains several related components |
| App version           | Select the version of Apollo, the current optional version is 1.9.2 |

After a few minutes, the Apollo cluster will be installed and running.

![apollo-3](https://static.goodrain.com/wechat/apollo/apollo-3.png)

### 3.3 Testing

Access the default domain name provided by component `Apollo-portal-1.9.2` , you can log in to the Apollo console, and in the system information, verify that the `PRO` environment is ready.

![apollo-4](https://static.goodrain.com/wechat/apollo/apollo-4.png)

### 3.4 Configuration

Deploy a highly available Apollo cluster on Rainbond主要包括环境变量、配置文件挂载、插件配置三个方面。

- 环境变量：通过在不同的组件页面中的环境配置中，可以自定义环境变量。Environment variables：Through the environment configuration in different component pages, environment variables can be customized.For example, for `Apollo-portal-1.9.2` , `APOLLO_PORTAL_ENVS=pro` is added by default to define the current portal managed environment.

- Profile：Configuration files can be set for components by setting the environment configuration in different component pages.

  - `Apollo-portal-1.9.2` Mount `/apollo-portal/config/apollo-env.properties` Meta addresses used to define different environments.

  - `Apollo-config-1.9.2` Mount `/apollo-configservice/config/application-github.properties` Used to declare the service address of the current environment config and admin.

- Plug-in configuration：defines the downstream call address in Rainbond by installing the export network governance plug-in for `Apollo-portal-1.9.2` `Apollo-config-1.9.2` , which is an implementation of Service Mesh microservice governance.Access the specified port of the downstream service by defining the domain name of the downstream service.For example, in the plug-in of `Apollo-portal-1.9.2` , the domain name for accessing `Apollo-config-1.9.2`  8080 port is `apollo-config-pro` , which is only the domain name defined in the configuration, and does not need to be defined the reason for the port.通过定义下游服务的域名，来访问下游服务的指定端口。如在 `Apollo-portal-1.9.2` 的插件中，访问 `Apollo-config-1.9.2`  8080 端口的域名为 `apollo-config-pro` ，这也是配置中只定义域名，而不需要定义端口的原因。

## 4. Advanced Features

### 4.1 Scaling the number of instances

`Apollo-portal-1.9.2` `Apollo-config-1.9.2` `Apollo-admin-1.9.2` components included in the Apollo Configuration Center are deployed using the Deployment controller, through the Rainbond built-in Service Mesh microservice framework Implement service discovery and communication.Therefore, these three components can expand multiple instances with one click to realize cluster deployment.故而这三个组件均可以一键扩展多个实例，实现集群化部署。

Take `Apollo-portal-1.9.2` as an example, click **to scale** , after modifying the number of **instances to** , click **to set**.

![apollo-5](https://static.goodrain.com/wechat/apollo/apollo-5.png)

### 4.2 Additional environment

Apollo Configuration Center supports docking with multiple environments and uses a unified Portal page for management.The Apollo cluster based on Rainbond one-click installation comes with `PRO` environment by default.Next, I will explain how to add a set of `DEV` environment in the Rainbond scenario, assuming that in the `DEV` environment, access `Apollo-config-Dev through <code>apollo-config-dev`and`apollo-admin-dev`respectively `Apollo-admin-Dev` components.基于 Rainbond 一键安装而来的 Apollo 集群默认附带了 `PRO` 环境。接下来讲解在 Rainbond 场景中，如何追加一套 `DEV` 环境，假设在 `DEV` 环境中，通过 `apollo-config-dev`、`apollo-admin-dev`来分别访问 `Apollo-config-Dev` `Apollo-admin-Dev` 组件。

1. Deploy another set of Apollo clusters and remove `Apollo-portal-1.9.2` `ApolloPortalDB`components in the new cluster.To facilitate management, modify the name of the `Apollo-config-1.9.2` `Apollo-admin-1.9.2` component.Add `Apollo-portal-1.9.2` to `Apollo-config-Dev` `Apollo-admin-Dev` dependencies.The topology is shown as follows：为了便于管理，修改 `Apollo-config-1.9.2` `Apollo-admin-1.9.2` 组件的名称。添加 `Apollo-portal-1.9.2` 到 `Apollo-config-Dev` `Apollo-admin-Dev` 的依赖。拓扑展示如下：

> Note that this step will trigger the conflict of connection information environment variables, remember to redefine the name you like for the internal port of the `Apollo-config-Dev` `Apollo-admin-Dev` component.

![apollo-6](https://static.goodrain.com/wechat/apollo/apollo-6.png)

2. On the **environment configuration** page, modify `Apollo-config-Dev` configuration file `/apollo-configservice/config/application-github.properties` , and modify the service addresses of config and admin to the expected values.

![apollo-10](https://static.goodrain.com/wechat/apollo/apollo-10.png)

3. 分别进入`Apollo-config-Dev` `Apollo-portal-1.9.2` 的插件页面，为其出口网络治理插件修改配置，Rainbond 内置的微服务框架，通过设定的域名（Domains）来定义下游服务的访问地址。Enter the plug-in pages of`Apollo-config-Dev` `Apollo-portal-1.9.2` respectively, modify the configuration for its export network governance plug-in, Rainbond's built-in microservice framework, and define downstream services through the set domain names (Domains) access address.Take `Apollo-portal-1.9.2` as an example, you need to configure the access domain names to `Apollo-config-Dev` `Apollo-admin-Dev`.

![apollo-7](https://static.goodrain.com/wechat/apollo/apollo-7.png)

After the configuration is complete, click **to update the configuration**, `Apollo-portal-1.9.2` to access `Apollo-config-Dev`through the domain name apollo-config-dev.

Similarly,`Apollo-config-Dev` needs to be configured to the access domain name of `Apollo-admin-Dev`.Update the configuration after the configuration is complete.配置完成后更新配置。

4. Modify the configuration of `Apollo-portal-1.9.2` to add the new `DEV` environment.

Modify the value of the environment variable `APOLLO_PORTAL_ENVS` and add the `dev` environment.

![apollo-8](https://static.goodrain.com/wechat/apollo/apollo-8.png)

Modify the configuration file `/apollo-portal/config/apollo-env.properties` and write the meta address of the `dev` environment.

![apollo-9](https://static.goodrain.com/wechat/apollo/apollo-9.png)

Update `Apollo-portal-1.9.2` component to make all configurations take effect.Check the system information and verify that the environment is added.查看系统信息，验证环境加入完成。

![apollo-11](https://static.goodrain.com/wechat/apollo/apollo-11.png)
