---
title: 应用管理
summary: 应用的管理，拓扑图，列表，应用的发布于备份
toc: true
asciicast: true
---


本文会让你更清晰的了解应用的概念，同时教你如果管理应用，以及应用内的服务批量处理。作为一个应用，还会讲解应用的分享，备份迁移与恢复。

## 一、什么是应用

服务是Rainbond可管理的最小服务单元，用户可以将多个服务组成一个复杂的业务系统，而这个业务系统就是一个应用，应用可以是一个demo，也可以是一个mysql集群。

## 二、基础操作

在当前应用页面，可以对应用下的服务组件进行批量操作,也可以对当前应用进行整体操作, 当应用下有多个服务组件可访问时，鼠标移动到访问按钮时会展现可访问的服务组件的名称。

<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/5.0/user-manual/team-operation2.gif" width="100%">

## 三、应用拓扑图

应用的拓扑图主要是展示应用下各服务组件的关系，更加清晰的看到个服务之间的关系以及每个服务的运行状态、流量等，从应用拓扑图中还可以进入到对应的服务组件详情页面，后期我们会增加拖拽拓扑图，即可完整服务之间的依赖关系，方便快捷，敬请期待

<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/5.0/user-manual/team-operation4.gif" width="100%">

## 四、创建服务组件说明

在拓扑图中创建的服务组件只可以创建在当前应用中，如果想在其他应用中创建，可在创建应用中去创建，也可在拓扑图中创建后修改该服务的所属应用；在拓扑图中创建的服务默认是创建并部署的，创建后会在拓扑图中会实时更新，如果选择创建不部署的操作，创建服务后会跳转到服务详情页面，可对当前的服务进行设置后再部署，目前的创建服务组件方式支持三种，源码构建，docker镜像构建以及从应用市场安装构建。

<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/5.0/user-manual/team-operation5.gif" width="100%">

## 五、应用分享

应用市场定义了支持大型分布式的数字化业务系统的标准云原生应用模型、它可以包含1-N个服务组件，模型包含其中每个服务组件资源及配置，插件资源及配置，拓扑关系、部署关系等。精心制作完成即可一键发布、一键安装。
在Rainbond中，服务是Rainbond可管理的最小服务单元，用户可以将多个服务组成一个复杂的业务系统，这套业务系统可以对外提供服务，也可以分享给其他组织独立部署，你可以将整套业务系统打包成一个`云市应用`，并选择将该应用发布到`团队`、`公司`、`好雨公有云市`。分享后的应用可供团队、公司或云市的用户一键安装部署完整的服务体系，实现标准化得一键交付部署。分享到不同的范围，可见性也有所不同，具体可见范围如下：

* 团队：只有当前团队下的成员可见
* 公司：当前企业下的所有成员可见
* 好雨云市：连接好雨公有云市的所有企业及用户可见

我们将一个`应用`内完整的业务解决方案集成体整体打包成一个`云市应用`，发布成功后，其他用户在创建应用时可以选择`从应用市场安装`的方式`一键安装部署`完整的服务体系，实现标准化得一键交付部署。

####  5.1 应用发布流程

**选择要分享的应用，点击`发布到市场`。**

> 提示：发布应用时，应用内所有服务的状态必须为运行中

<img src="https://grstatic.oss-cn-shanghai.aliyuncs.com/images/docs/5.0/user-manual/1544492992679.jpg" width='100%' />

**完善应用信息**

> 填写应用基本信息

* 应用名：要发布的应用名称
* 版本：应用发布版本  (当同一应用组多次发布时，如果版本号相同，则会覆盖已发布的该版本应用)
* 分享范围：发布的可见范围
* 应用说明：应用的简单描述
* 图标：应用LOGO

<img src="https://static.goodrain.com/images/docs/3.7/user-manual/share-2.jpg" width='100%' />

> 填写每个服务的配置信息

* 环境变量：编辑该服务默认的环境变量，勾选`可修改`，则其他用户安装此应用后可编辑这个环境的值，反之不可编辑。
* 伸缩规则：定义该服务可伸缩的最大最小节点数，及节点伸缩步长，最小安装内存限制。

<img src="https://static.goodrain.com/images/docs/3.7/user-manual/share-3.jpg" width='100%' />

**提交发布任务**

完善应用信息后，点击`提交`，向数据中心发起同步任务。由数据中心的`rbd-chaos`组件对应用中的每一个服务进行数据同步。如果是发布到`好雨公有云市`，数据中心会将应用所需的镜像或源码包同步到好雨公有仓库及FTP服务器存储，并将应用的模版数据保存到Console数据库并发送到好雨云市保存。如果是发布到`团队`或`公司`，则应用所需的镜像或源码包同步到本数据中心，并将应用的模版数据保存在Console数据库。

<img src="https://static.goodrain.com/images/docs/3.7/user-manual/share-4.jpg" width='100%' />

**确认发布**

当应用中的所有服务及插件全部完成同步后，点击`确认发布`，即可完成应用发布。发布成功后可在`创建应用`下的`从应用市场安装`中对应的范围下看到你发布的应用。

<img src="https://static.goodrain.com/images/docs/3.7/user-manual/share-5.jpg" width='100%' />



<img src="https://static.goodrain.com/images/docs/3.7/user-manual/share-6.jpg" width='100%' />


**上架应用**

如果想要可以在公有云市中找到发布的应用，那么需要在云市中上架该应用。上架后的应用可以被连接好雨公有云市的所有企业及用户看到。

- 登录[Goodrain](https://www.goodrain.com/)官网,进入 企业中心 > 应用市场 > 自有市场 > 分享应用管理。
> 登录的时候需要用该企业管理员的Rainbond账号登陆。

- 信息编辑。使用Markdown编写应用的详细介绍，完善应用`README`，让用户可以更好地去了解使用应用。

<img src="https://static.goodrain.com/images/docs/3.7/user-manual/market.gif" width='100%' />

- 设置价格。

<img src='/uploads/default/original/2X/3/3e0aa3de5b0b0970a171680fc624fe4c6e3377d6.jpg'>

- 上架。

<img src='/uploads/default/original/2X/5/5cdfffcd677910f5fea98215efeaeb8af7e2b935.gif'>
 
完成上架之后，我们就可以在云端中找到你上架的应用。

## 六、应用备份恢复与迁移

应用的备份与恢复用于整个业务的整体备份与恢复，以及跨数据中心的应用迁移。

### 6.1 整个业务状态的快照备份与恢复

`备份` 对于生成环境的业务系统，我们需要对其进行定期的全量备份操作，过去我们针对数据单独进行备份，或对数据库进行单独备份。缺乏一种全局统一备份的机制，特别是对于分布式应用。Rainbond应用备份与恢复完成对业务系统的整体的、全量的备份，以实现整个系统故障时的全局回滚。这里所说的备份主要指冷备份，需要暂停业务服务，如需要不停止服务实习备份例如Mysql类的局部应用的热备份参考并使用mysql数据备份插件。
备份操作如下：

<img src="https://static.goodrain.com/images/docs/3.6/advanced-operation/backup.gif" width="100%" />

备份操作分为`本地备份`和`云端备份`两种。

> 本地备份：将一组应用备份在本地，本地备份的应用无法进行跨数据中心和租户的迁移操作。
> 云端备份：需要配置sftp服务器和私有hub仓库才能进行云端备份，云端备份可以实现应用的跨数据中心和租户操作，并且还能支持该组备份的导出。目前企业版支持管理后台配置sftp和hub仓库的配置。


`恢复` 对于已经备份成功的一组应用，使用恢复可以将该组应用进行恢复操作。
恢复操作如下：
<img src="https://static.goodrain.com/images/docs/3.6/advanced-operation/recover.gif" width="100%">

> 恢复操作过程中请勿关闭恢复页面，否则可能会导致恢复失败。为了保证您的数据安全，恢复操作过程我们会生成一份您的备份应用的拷贝，您可以在恢复的最后一步中选择删除原有的应用。

- `导出备份` 导出备份会将会导出一份备份的数据，目前只有云端备份支持备份的导出。

- `导入备份` 在导出备份以后，您可以在别的云帮平台（可以访问网络）将导出的备份进行导入，导入后会生成相应的备份记录，您可继续后续操作。

#### 本地恢复后的注意事项

用户应用备份后在本数据中心恢复时，由于应用本身发生变化会导致非HTTP协议对外端口不再和原有一直。为了用户的应用备份后恢复后和原有端口一直，我们提供了修改非http对外端口的功能

 <img src="https://static.goodrain.com/images/docs/3.6/advanced-operation/update-port.gif" style="border:1px solid #eee;max-width:100%" />

> 修改端口的实质是将该端口与原有的非http对外端口发生调换，所以可选的端口只能是已有的非http端口。


### 6.2 应用的跨租户和跨数据中心迁移

由于我们做到全局的全量备份，借助此我们可以做到应用的整体迁移，包括跨租户迁移和跨数据中心迁移。

在已经备份的情况下，可以选择迁移操作来进行应用的迁移
迁移操作如下：

<img src="https://static.goodrain.com/images/docs/3.6/advanced-operation/migrate.gif" width="100%">

应用完成迁移以后，会跳转到对应的数据中心和租户以方便您查看迁移后的应用。