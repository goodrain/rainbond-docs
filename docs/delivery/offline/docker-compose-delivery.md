---
title: DockerCompose 交付
---

本文介绍如何使用 Docker Compose 进行交付。

## 准备工作

1. 拥有一套 Rainbond 集群和一个离线 DockerCompose 环境，模拟开发环境及交付环境(开发环境为在线环境，交付环境为离线环境)。

2. 开发环境安装，参考[快速安装](/docs/quick-start/quick-install)，离线有 DockerCompose 环境即可。

3. 在开发环境已有正常运行的应用，可参考[快速入门](/docs/quick-start/getting-started)。

## 发布应用模版

1. 在应用拓扑图页面左侧，选择 `发布->发布到组件库`， 即可进入模版设置页面。各个参数详细说明参考[附录1: 模版设置页面参数说明](/docs/delivery/offline/docker-compose-delivery#template-setting)

2. 新建一个应用模版，可选择发布范围为企业，设定好发布的版本，点击`提交`，接下来将会同步所有组件的镜像，推送到本地镜像仓库中。同步完成后，点击`确认发布`，即发布完成。接下来在 `平台管理->应用市场->本地组件库`，即可看到发布好的应用模版。

:::caution
注：仅有企业管理员可以看到平台管理按钮。
:::

## 导出应用模版

1. `平台管理->应用市场->本地组件库`中，在刚刚发布完成的应用模版最右侧，选择`导出应用模版`，你可以选择需要导出的版本，和导出哪种类型的包。这里我们选择`DockerCompose规范`，点击`导出`。这个包将包含应用所有镜像和 DockerCompose 配置文件以及启动脚本。

2. 导出完成后，将应用模版下载到本地，保存至U盘/光盘等移动存储设备中，带到离线交付环境中去。

## 离线环境部署

1. 将导出的包解压，你将会得到如下所示的目录结构：

```bash
dockercompose-package/
├── component-images.tar #镜像包
├── docker-compose.yaml #docker-compose 配置文件
└── run.sh #启动脚本
```

2. 接下来你可以使用如下命令管理该应用：

```bash
./run.sh start #启动应用

./run.sh stop #停止应用
```

-----------

## 附录1: 模版设置页面参数说明 {#template-setting}

### 1. 应用模版及发布版本设置

- 创建应用模版时参数说明：

| 选项名   | 说明                                                                         |
| -------- | ---------------------------------------------------------------------------- |
| 名称     | 定义应用名称（必填）                                                         |
| 发布范围 | 应用模板的可见范围，**当前团队**为当前团队可见，**企业**所有团队可见（必选） |
| 分类标签 | 应用标签，可按照架构、行业、部署方式进行分类                                 |
| 简介     | 应用描述，帮助使用者了解此应用                                               |
| Logo     | 应用的 Logo 图片                                                             |

- 创建应用模板后定义应用发布版本：

| 选项名   | 说明                                                                                                                           |
| -------- | ------------------------------------------------------------------------------------------------------------------------------ |
| 版本号   | 当同应用多次发布时，如果版本号相同，则会覆盖已发布的版本，如果不同，将发布为新版本，应用升级或回滚时，平台根据版本判断（必填） |
| 版本别名 | 应用别名，例如 高级版，初级版                                                                                                  |
| 版本说明 | 当前发布版本的说明，可区分不同版本的功能差异等信息                                                                             |
| 作为插件 | 当该应用模版下有插件时，选中该选项，则可以在`团队页面-插件-从本地组件库安装`，直接安装对应的插件而不安装应用                             |

### 2. 发布组件模型配置：

| 选项名   | 说明                                                                 |
| -------- | -------------------------------------------------------------------- |
| 连接信息 | 当连接信息中出现密码类的信息，可选择每次部署时自动生成随机值         |
| 环境变量 | 编辑该组件默认的环境变量                                             |
| 伸缩规则 | 定义该组件可伸缩的最大最小节点数，及节点伸缩步长，最小安装内存限制。 |

### 3. 发布插件模型信息：

要发布的应用中其组件携带有插件时，会进行展示并在发布过程中跟随组件发布。

### 4. K8s 资源：

要发布的应用中存在定义好的 K8s 资源时，也会进行展示并在发布过程中跟随应用发布。

所有信息配置完毕后，点击**提交**按钮进行发布，业务开发过程中定义的组件间依赖关系、环境配置、持久化存储、插件、运行环境及上述定义的所有信息都将会被打包发布。
