---
title: "单机版应用迁移"
description: "介绍如何将单机版部署到应用迁移到集群部署"
weight: 1001
---

## 概述

本文将介绍如何将单机版上已部署的应用迁移到集群部署。

## 前提

- 已经[基于主机安装](/docs/installation/install-with-ui/#从主机开始安装)了新的 Kubernetes 集群并完成对接。

## 操作流程

### 1. 设置本地组件库镜像仓库

每套 Rainbond 集群都会安装默认的镜像仓库 rbd-hub，它只能在 Kubernetes 集群内部访问，当前集群的所有镜像都会同步到此镜像仓库中，包括发布的本地组件库的应用模型镜像。

当控制台对接了多套 Rainbond 集群时，在 A 集群中发布应用到本地组件库中，如果不配置同步的镜像仓库地址，那么将会同步到默认的镜像仓库中，则 B 集群无法从本地组件库安装此应用。

当你通过主机安装了新的集群以后，在集群页面，可以看到两个集群，其中一个是 K3s 集群，一个是新部署的 Kubernetes 集群。因此为了让新部署的 Kubernetes 集群能拉取到原应用的镜像。我们需要在 `企业视图->设置->内部组件库镜像仓库` 中，配置一个公有的镜像仓库。

参数如下:

|  | 镜像仓库信息 |
| ---- | ---- |
| 仓库地址 | 镜像仓库的域名，如 docker.io 或 registry.cn-hangzhou.aliyuncs.com |
| 命名空间 | 镜像仓库的命名空间，当镜像地址为`rainbond/rainbond:v5.13.0-release` 时，该值为`rainbond` 。对于阿里云镜像仓库地址`registry.cn-hangzhou.aliyuncs.com/goodrain/rainbond:v5.13.0-release`时，该值为`goodrain` |
| 用户名 | 自定义 |
| 密码 | 自定义 |

### 2. 将原来应用发布到本地组件库

进入原来使用 K3s 集群的团队，进入你想要迁移的应用。在应用拓扑图页面左侧，选择 `发布->发布到组件库->新建应用模版->发布范围选择企业->填写版本号->点击提交->镜像同步完成后确认发布` 。回到 `企业视图->应用市场` ，此时可以看到刚刚发布的应用模版。

### 3. 在新部署的集群中安装应用

在刚发布的应用模版右侧，点击 `安装->新建团队->集群选择新部署的 Kubernetes 集群->确定部署` ，即可将单机版部署的业务部署到新集群中。最后回到单机版的应用，关闭应用即可。

## 下一步

现在你已经成功将单机版部署的应用迁移到了集群中，接下来你可以尝试：

- [控制台高可用](/docs/installation/ha-deployment/console-recover): 将单机版的控制台也迁移到集群中部署。
- [高可用部署](/docs/installation/ha-deployment/): 部署一个高可用集群用于生产环境。
