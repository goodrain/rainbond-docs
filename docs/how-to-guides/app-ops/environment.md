---
title: 环境配置管理
description: 管理应用的环境变量、配置文件、配置组等。
keywords:
- 环境变量
- 配置文件
- 配置组
---

:::warning
以上环境变量的操作均需要更新/重启组件后生效。
:::

## 环境变量

Rainbond 为组件提供了环境变量的管理功能，用户可以在组件中添加、删除、修改环境变量，以及将环境变量转移为依赖的环境变量。

* 将环境变量转移为依赖的环境变量，在该组件被依赖时，此环境变量将会注入到依赖了该组件的组件中。
  
  > 转移后环境变量依然会在当前组件中生效。

## 配置文件管理

Rainbond 为组件提供了配置文件的管理功能，用户可以在组件中添加、删除、修改配置文件，以及共享其他组件的配置文件。

进入到组件的环境配置页下，点击添加配置文件，内容如下:
* 配置文件名称：自定义
* 配置文件挂载路径：需填写绝对路径包含文件名，例如：/data/test.conf
* 权限：文件的权限，如: 777
* 配置文件内容：自定义

同时支持动态渲染环境变量。例如 Ningx 配置文件本身不支持环境变量渲染，但可以通过 Rainbond 的配置文件挂载实现环境变量动态渲染，如下：

```nginx
server {
  listen  ${PORT:80};
  ...
  location /api {
    proxy_pass http://${API_HOST}:${API_PORT};
  }
}
```

### 共享配置文件

共享配置文件是将别的组件的配置文件挂载到当前的组件中，适用于多个组件配置文件一致的场景。

### 挂载共享配置文件

进入到组件的环境配置页下，点击挂载共享配置文件，内容如下:
* 填写本地挂载配置文件路径，如：/data/test.conf

## 配置组

配置组是一组可以在同一应用下的多个组件中同时生效的一组环境变量，配置组非常适合在需要为很多组件配置统一的环境变量时使用。

进入到应用视图下，点击配置组，添加配置组。保存后需更新组件才会生效。

## 默认环境变量

组件的运行环境除了用户自己设置的环境变量以外，平台还会默认注入默认的环境变量。

| 变量名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| _PORT            | 端口号                                                       |
| _PROTOCOL        | 端口协议类型                                                 |
| _TENANT_ID       | 租户 ID                                                      |
| _SERVICE_ID      | 应用 ID                                                      |
| _SERVICE_NAME    | 应用名称，由应用英文名和组件英文名组成，格式为：应用英文名-组件英文名 |
| _NAMESPACE       | 命名空间                                                     |
| _MEMORY_SIZE     | `micro、small`等，对应关系见下文                             |
| _SERVICE_POD_NUM | 实例数量                                                     |
| _HOST_IP         | 所在宿主机 IP 地址                                           |
| _POD_IP          | 运行时的 IP 地址                                             |
| _POD_NAME        | Pod 名称                                                     |

内存大小与`MEMORY_SIZE`环境变量值的对应关系

> JVM 配置可根据 MEMORY_SIZE 变量进行动态调整，如 `JAVA_OPTS="-Xms${MEMORY_SIZE}m -Xmx${MEMORY_SIZE}m"`

| 内存/Mb | 环境变量值 |
| ------- | ---------- |
| 128     | micro      |
| 256     | small      |
| 512     | medium     |
| 1024    | large      |
| 2048    | 2xlarge    |
| 4096    | 4xlarge    |
| 8192    | 8xlarge    |
| 16384   | 16xlarge   |
| 32768   | 32xlarge   |
| 65536   | 64xlarge   |